import json
import os

def download_citation(pii):
    os.system(f"""curl --output bibtexes/{pii}.bibtex 'https://www.sciencedirect.com/sdfe/arp/cite?pii={pii}&format=text%2Fx-bibtex&withabstract=true' -H 'User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:137.0) Gecko/20100101 Firefox/137.0' -H 'Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8' -H 'Accept-Language: en-US,en;q=0.5' -H 'DNT: 1' -H 'Connection: keep-alive' -H 'Referer: https://www.sciencedirect.com/science/article/pii/S2212671613000553?dgcid=api_sd_search-api-endpoint' -H 'Cookie: EUID=5aac76a7-7253-42d6-9663-19e97b7ba4af; id_ab=AEG; OptanonConsent=isGpcEnabled=0&datestamp=Thu+Apr+17+2025+14%3A18%3A03+GMT%2B0300+(Moscow+Standard+Time)&version=202503.1.0&browserGpcFlag=0&isIABGlobal=false&hosts=&consentId=4826ca72-caed-4e1c-92bf-e61abb3b971f&interactionCount=1&isAnonUser=1&landingPath=NotLandingPage&groups=1%3A1%2C3%3A1%2C2%3A1%2C4%3A1&geolocation=RU%3BMOW&AwaitingReconsent=false; OptanonAlertBoxClosed=2024-11-29T06:31:35.578Z; AMCV_4D6368F454EC41940A4C98A6%40AdobeOrg=179643557%7CMCIDTS%7C20195%7CMCMID%7C56312424502115885010512437810716520586%7CMCAID%7CNONE%7CMCOPTOUT-1744895882s%7CNONE%7CMCAAMLH-1733466692%7C6%7CMCAAMB-1744820349%7Cj8Odv6LonN4r3an7LhD3WZrU1bUpAkFkkiY1ncBR96t2PTI%7CMCCIDH%7C-1660478464%7CvVersion%7C5.5.0; s_pers=%20c19%3Dsd%253Asearch%253Aresults%253Aguest%7C1732863709998%3B%20v68%3D1732861896045%7C1732863710000%3B%20v8%3D1732862028705%7C1827470028705%3B%20v8_s%3DFirst%2520Visit%7C1732863828705%3B; cf_clearance=Pz_FKsBl6anG2YHlmwMPqhq31XdiPvLrj9HbeQoqIKQ-1744888682-1.2.1.1-cgxWyS0ueqkCZjWhL1aFQjT0qQjqpaqGq_uIQPfhQy4q4kVkcBq3ZgoN6c1UonWi5gh62SA9.Usgh4VSh4OZ0k4UH6485kzVZL9VoY8.4LpvngAc63u99VdsMJbEcCO8Sq75f9fml3cClJdacjsyEcfWuyuey3PUKUf4Q0wyD2O61OZjeDF3otEXbvX2hsDGESS1EyDJmc3oLw19.kwtYzfKzGSK0hTuOrDu4m3C5y0_onhe7YXNT1wzZZdp30WqV4Mr1JH1OOo6uJFnjMWWMd8dHic2QimccoUpGuXDNfAx_6KwCLcuXAU8UQ2yI_lW4BIfHRyaDTHRJuEilbXJGIH5gzcQn9tEsFO4_jr0KNg; sd_session_id=ce82cca16cea28480308fb812fa054f0c125gxrqb; acw=ce82cca16cea28480308fb812fa054f0c125gxrqb%7C%24%7C9352E23FBE5DE13D9E3E03A08B0ED463A04EF5098CE3F49C23457CB78BBFF565C249A58D9965ABF8E1C11F8F53932CEAE3E142EA50B32E940E9169905BBD791CAFE9C31A29ED2080B6DA1F7CB1786ABB; MIAMISESSION=b83706c8-1564-4f19-8601-b797269d3284:3922341481; _cfuvid=vXwU6nGac_uXK2rUS9qFN_0qxp0EDwQBhVOHE2sfzsM-1744888681986-0.0.1.1-604800000; AMCVS_4D6368F454EC41940A4C98A6%40AdobeOrg=1; ANONRA_COOKIE=77D6BB0E8EEF0F595474924A8695E5568ED0B6BF8929DC7A33055E3A1B1D16B538758FE9DCD539859DDE5123888307B204977B0B2E52F3FA; SD_REMOTEACCESS=eyJhY2NvdW50SWQiOiI3MzMzOCIsInRpbWVzdGFtcCI6MTc0NDg4ODY4MTg1MSwiYXV0aGVudGljYXRpb25NZXRob2QiOiJJUCJ9; __cf_bm=wc5J37d.SNfqFBZlTErPn_PlhqVyUDr57gQZjOMNRGo-1744888681-1.0.1.1-D4aEcw7vaeC9Wc47Ft54Jajw.QktLPTmOJmH9433OCShOyMN2nvtoiIGlUSy4uanoz8E5aAdOADZEXw9ihc_YcxZeO6S4zcctmdvrrAkSiU' -H 'Upgrade-Insecure-Requests: 1' -H 'Sec-Fetch-Dest: document' -H 'Sec-Fetch-Mode: navigate' -H 'Sec-Fetch-Site: same-origin' -H 'Sec-Fetch-User: ?1' -H 'Priority: u=0, i' -H 'Pragma: no-cache' -H 'Cache-Control: no-cache' -H 'TE: trailers'""")

for line in open('09_final_search_results.jsonl'):
    data = json.loads(line)
    download_citation(data['pii'])